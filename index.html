<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏™‡πà‡∏á‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏à</title>
    <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏° Font Awesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            background: url('https://images.dmc.tv/wallpaper/raw/14180.jpg') center/cover no-repeat;
        }
        .navbar {
            width: 100%;
            background-color: #333;
            padding: 1% 2%;
            position: fixed;
            top: 0;
            left: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 10;
        }
        .navbar a {
            color: white;
            text-decoration: none;
            padding: 0.8% 1.5%;
            font-size: clamp(14px, 2vw, 18px);
        }
        .navbar a:hover {
            background-color: #555;
        }
        .navbar .right-links {
            display: flex;
            align-items: center;
        }
        .navbar .right-links a {
            margin-left: 10px;
        }
        .card-container {
            perspective: 1000px;
            width: clamp(300px, 80vw, 400px);
            height: clamp(400px, 60vh, 500px);
            position: relative;
            margin: 10vh auto 5vh;
        }
        .card {
            position: absolute;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            transition: transform 0.8s;
        }
        .card.flipped {
            transform: rotateY(180deg);
        }
        .front, .back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .front {
            background: url('image/default.jpg') center/contain no-repeat;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 5%;
            color: white;
            text-shadow: 0 0 5px rgba(0,0,0,0.8);
        }
        .front h2 {
            align-self: flex-end;
        }
        .front .festival-message {
            font-size: clamp(16px, 3vw, 22px);
            text-align: center;
            background: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border-radius: 10px;
        }
        .back {
            background-color: white;
            transform: rotateY(180deg);
            padding: 5%;
            text-align: center;
        }
        .front h2, .back h3 {
            font-size: clamp(18px, 3vw, 24px);
            margin-bottom: 2%;
        }
        select, input, textarea {
            margin: 2% 0;
            padding: 2%;
            width: 90%;
            font-size: clamp(12px, 2vw, 16px);
        }
        textarea {
            resize: none;
            height: 80px;
        }
        button {
            padding: 2% 5%;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: clamp(12px, 2vw, 16px);
        }
        button:hover {
            background-color: #45a049;
        }
        footer {
            width: 100%;
            background-color: #333;
            color: white;
            text-align: center;
            padding: 1% 0;
            font-size: clamp(12px, 1.5vw, 16px);
        }
        .progress-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .progress-bar-container {
            width: 300px;
            background-color: #ddd;
            border-radius: 5px;
            overflow: hidden;
            position: relative;
        }
        .progress-bar {
            height: 30px;
            background-color: #4CAF50;
            width: 0%;
            transition: width 0.1s linear;
            text-align: center;
            line-height: 30px;
            color: white;
            font-weight: bold;
        }
        .popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            z-index: 1001;
            text-align: center;
            max-width: 80%;
            white-space: pre-wrap;
        }
        .popup button {
            margin-top: 10px;
            background-color: #4CAF50;
        }
        .popup-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }
        .image-change-popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            z-index: 1001;
            text-align: center;
            width: 300px;
        }
        .image-change-popup h3 {
            margin-bottom: 15px;
            font-size: clamp(16px, 2vw, 20px);
        }
        .image-change-popup input {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            font-size: clamp(12px, 1.5vw, 16px);
        }
        .image-change-popup .button-group {
            display: flex;
            justify-content: space-between;
        }
        .image-change-popup button {
            width: 48%;
            padding: 8px;
        }
        .image-change-popup .close-btn {
            background-color: #f44336;
        }
        .image-change-popup .close-btn:hover {
            background-color: #d32f2f;
        }
        .datetime {
            color: white;
            font-size: clamp(12px, 1.5vw, 16px);
            padding: 0.8% 1.5%;
        }
        #customMessage {
            display: none;
        }
        @media (max-width: 600px) {
            .card-container {
                width: 90vw;
                height: 50vh;
            }
            .navbar {
                padding: 2% 3%;
            }
            .datetime {
                font-size: clamp(10px, 1.2vw, 14px);
            }
            .image-change-popup {
                width: 90%;
            }
            .front .festival-message {
                font-size: clamp(14px, 2.5vw, 18px);
            }
        }
    </style>
</head>
<body>
    <div class="navbar">
        <div class="datetime" id="datetime"></div>
        <div class="right-links">
            <a href="#" onclick="showImageChangePopup()"><i class="fas fa-image"></i></a>
            <a href="settings.html"><i class="fas fa-cog"></i></a>
        </div>
    </div>

    <div class="card-container">
        <div class="card" id="card">
            <div class="front" id="cardFront">
                <div class="festival-message" id="festivalMessage"></div>
                <div>
                    <h2>‡∏™‡πà‡∏á‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏à</h2>
                    <button onclick="flipCard()">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
                </div>
            </div>
            <div class="back">
                <h3>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö</h3>
                <select id="messageType" onchange="updateBlessingOptions()">
                    <option value="festival">‡∏≠‡∏ß‡∏¢‡∏û‡∏£‡∏ï‡∏≤‡∏°‡πÄ‡∏ó‡∏®‡∏Å‡∏≤‡∏•</option>
                    <option value="encouragement">‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏à</option>
                    <option value="birthday">‡∏≠‡∏ß‡∏¢‡∏û‡∏£‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î</option>
                    <option value="buddhist">‡∏ß‡∏±‡∏ô‡∏û‡∏£‡∏∞</option>
                </select>
                <select id="blessing" onchange="toggleCustomMessage()">
                    <option value="1">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 1</option>
                    <option value="2">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 2</option>
                    <option value="3">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 3</option>
                    <option value="custom">‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏≠‡∏á</option>
                </select>
                <textarea id="customMessage" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏≠‡∏ß‡∏¢‡∏û‡∏£‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì"></textarea>
                <input type="text" id="firstName" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
                <input type="text" id="lastName" placeholder="‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°/‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô/‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î ‡∏´‡∏£‡∏∑‡∏≠ -">
                <button onclick="submitBlessing()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á</button>
            </div>
        </div>
    </div>
    <footer>
        <p>¬© 2025 ‡∏™‡πà‡∏á‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏à | ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢ ‡∏Ñ‡∏£‡∏π‡∏ô‡∏¥‡∏î ‡∏®‡∏¥‡∏©‡∏¢‡πå‡∏´‡∏•‡∏ß‡∏á‡∏û‡πà‡∏≠‡πÄ‡∏™‡∏∑‡∏≠ ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏õ‡πÅ‡∏Å‡∏£‡∏°‡πÇ‡∏î‡∏¢ xAI</p>
    </footer>

    <!-- Progress Bar HTML -->
    <div class="progress-overlay" id="progressOverlay">
        <div class="progress-bar-container">
            <div class="progress-bar" id="progressBar">0%</div>
        </div>
    </div>

    <!-- Popup HTML -->
    <div class="popup-overlay" id="popupOverlay"></div>
    <div class="popup" id="popup">
        <p id="popupMessage"></p>
        <button onclick="hidePopup()">‡∏ï‡∏Å‡∏•‡∏á</button>
    </div>

    <!-- Image Change Popup HTML -->
    <div class="popup-overlay" id="imageChangeOverlay"></div>
    <div class="image-change-popup" id="imageChangePopup">
        <h3>‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</h3>
        <input type="file" id="imageFile" accept="image/*">
        <div class="button-group">
            <button onclick="changeImage()">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î</button>
            <button class="close-btn" onclick="hideImageChangePopup()">‡∏õ‡∏¥‡∏î</button>
        </div>
    </div>

    <script>
        let currentImageUrl = localStorage.getItem('currentImage') || 'image/default.jpg';

        // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ó‡∏®‡∏Å‡∏≤‡∏•‡πÅ‡∏•‡∏∞‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á
        const festivalImages = {
            '04-14': { // ‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß: 14 ‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô
                url: 'image/family_day.jpg',
                alt: '‡∏†‡∏≤‡∏û‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß‡∏≠‡∏ö‡∏≠‡∏∏‡πà‡∏ô‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß',
                message: '‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß'
            },
            '01-01': { // ‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà: 1 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°
                url: 'image/new_year.jpg',
                alt: '‡∏†‡∏≤‡∏û‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ‡πÑ‡∏ü‡πÄ‡∏â‡∏•‡∏¥‡∏°‡∏â‡∏•‡∏≠‡∏á‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà',
                message: '‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà'
            },
            '04-13': { // ‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå: 13-15 ‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô
                url: 'image/songkran.jpg',
                alt: '‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏î‡∏ô‡πâ‡∏≥‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå',
                message: '‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå'
            },
            '04-14-songkran': { // ‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 14
                url: 'image/songkran.jpg',
                alt: '‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏î‡∏ô‡πâ‡∏≥‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå',
                message: '‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå'
            },
            '04-15': { // ‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 15
                url: 'image/songkran.jpg',
                alt: '‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏î‡∏ô‡πâ‡∏≥‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå',
                message: '‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå'
            },
            '12-25': { // ‡∏Ñ‡∏£‡∏¥‡∏™‡∏ï‡πå‡∏°‡∏≤‡∏™: 25 ‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°
                url: 'image/christmas.jpg',
                alt: '‡∏†‡∏≤‡∏û‡∏ï‡πâ‡∏ô‡∏Ñ‡∏£‡∏¥‡∏™‡∏ï‡πå‡∏°‡∏≤‡∏™‡πÅ‡∏•‡∏∞‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç',
                message: '‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏¥‡∏™‡∏ï‡πå‡∏°‡∏≤‡∏™'
            },
            '11-12': { // ‡∏•‡∏≠‡∏¢‡∏Å‡∏£‡∏∞‡∏ó‡∏á: ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á 12 ‡∏û.‡∏¢. 2025
                url: 'image/loy_krathong.jpg',
                alt: '‡∏†‡∏≤‡∏û‡∏Å‡∏£‡∏∞‡∏ó‡∏á‡∏•‡∏≠‡∏¢‡πÉ‡∏ô‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≥‡∏¢‡∏≤‡∏°‡∏Ñ‡πà‡∏≥‡∏Ñ‡∏∑‡∏ô',
                message: '‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡∏•‡∏≠‡∏¢‡∏Å‡∏£‡∏∞‡∏ó‡∏á'
            },
            '01-29': { // ‡∏ï‡∏£‡∏∏‡∏©‡∏à‡∏µ‡∏ô: ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á 29 ‡∏°.‡∏Ñ. 2025
                url: 'image/chinese_new_year.jpg',
                alt: '‡∏†‡∏≤‡∏û‡πÇ‡∏Ñ‡∏°‡πÅ‡∏î‡∏á‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ï‡∏£‡∏∏‡∏©‡∏à‡∏µ‡∏ô',
                message: '‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏ß‡∏±‡∏ô‡∏ï‡∏£‡∏∏‡∏©‡∏à‡∏µ‡∏ô'
            },
            '02-14': { // ‡∏ß‡∏≤‡πÄ‡∏•‡∏ô‡πÑ‡∏ó‡∏ô‡πå: 14 ‡∏Å.‡∏û.
                url: 'image/valentine.jpg',
                alt: '‡∏†‡∏≤‡∏û‡∏´‡∏±‡∏ß‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡∏î‡∏≠‡∏Å‡∏Å‡∏∏‡∏´‡∏•‡∏≤‡∏ö‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ß‡∏≤‡πÄ‡∏•‡∏ô‡πÑ‡∏ó‡∏ô‡πå',
                message: '‡∏£‡∏±‡∏Å‡∏´‡∏ß‡∏≤‡∏ô‡∏â‡πà‡∏≥‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ß‡∏≤‡πÄ‡∏•‡∏ô‡πÑ‡∏ó‡∏ô‡πå'
            },
            '02-12': { // ‡∏ß‡∏±‡∏ô‡∏°‡∏≤‡∏Ü‡∏ö‡∏π‡∏ä‡∏≤: ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á 12 ‡∏Å.‡∏û. 2025
                url: 'image/makha_bucha.jpg',
                alt: '‡∏†‡∏≤‡∏û‡πÄ‡∏ó‡∏µ‡∏¢‡∏ô‡πÉ‡∏ô‡∏û‡∏¥‡∏ò‡∏µ‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡πÄ‡∏ó‡∏µ‡∏¢‡∏ô‡∏ß‡∏±‡∏ô‡∏°‡∏≤‡∏Ü‡∏ö‡∏π‡∏ä‡∏≤',
                message: '‡∏ß‡∏±‡∏ô‡∏°‡∏≤‡∏Ü‡∏ö‡∏π‡∏ä‡∏≤ ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏à‡∏¥‡∏ï‡πÉ‡∏à‡∏™‡∏á‡∏ö'
            },
            'buddhist': { // ‡∏ß‡∏±‡∏ô‡∏û‡∏£‡∏∞
                url: 'image/buddhist_day.jpg',
                alt: '‡∏†‡∏≤‡∏û‡∏û‡∏£‡∏∞‡∏û‡∏∏‡∏ó‡∏ò‡∏£‡∏π‡∏õ‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏û‡∏£‡∏∞',
                message: '‡∏ß‡∏±‡∏ô‡∏û‡∏£‡∏∞ ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏à‡∏¥‡∏ï‡πÉ‡∏à‡∏ú‡πà‡∏≠‡∏á‡πÉ‡∏™'
            }
        };

        // ‡∏≠‡πá‡∏≠‡∏ö‡πÄ‡∏à‡πá‡∏Å‡∏ï‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏ß‡∏¢‡∏û‡∏£
        const blessingOptions = {
            festival: [
                { value: "1", text: "‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏ï‡∏•‡∏≠‡∏î‡∏õ‡∏µ" },
                { value: "2", text: "‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏™‡∏î‡∏ä‡∏∑‡πà‡∏ô‡∏£‡∏∑‡πà‡∏ô‡πÄ‡∏£‡∏¥‡∏á" },
                { value: "3", text: "‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏¥‡∏™‡∏ï‡πå‡∏°‡∏≤‡∏™ ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏û‡∏ö‡πÅ‡∏ï‡πà‡∏™‡∏¥‡πà‡∏á‡∏î‡∏µ‡πÜ" },
                { value: "4", text: "‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡∏•‡∏≠‡∏¢‡∏Å‡∏£‡∏∞‡∏ó‡∏á ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏£‡∏≤‡∏ö‡∏£‡∏∑‡πà‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏µ‡πà‡∏¢‡∏°‡∏î‡πâ‡∏ß‡∏¢‡πÅ‡∏™‡∏á‡∏™‡∏ß‡πà‡∏≤‡∏á" },
                { value: "5", text: "‡∏ß‡∏±‡∏ô‡∏û‡∏£‡∏∞‡∏ô‡∏µ‡πâ ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏à‡∏¥‡∏ï‡πÉ‡∏à‡∏ú‡πà‡∏≠‡∏á‡πÉ‡∏™ ‡∏°‡∏µ‡∏™‡∏ï‡∏¥ ‡πÅ‡∏•‡∏∞‡∏û‡∏ö‡πÅ‡∏ï‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏™‡∏á‡∏ö" },
                { value: "custom", text: "‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏≠‡∏á" }
            ],
            encouragement: [
                { value: "1", text: "‡∏™‡∏π‡πâ‡πÜ ‡∏ô‡∏∞ ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏ú‡πà‡∏≤‡∏ô‡∏û‡πâ‡∏ô‡∏ó‡∏∏‡∏Å‡∏≠‡∏∏‡∏õ‡∏™‡∏£‡∏£‡∏Ñ" },
                { value: "2", text: "‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏à‡∏ó‡∏µ‡πà‡∏î‡∏µ‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡πÜ ‡∏ß‡∏±‡∏ô" },
                { value: "3", text: "‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏≥‡πÑ‡∏î‡πâ! ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏∞Succes‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à" },
                { value: "custom", text: "‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏≠‡∏á" }
            ],
            birthday: [
                { value: "1", text: "‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á ‡πÅ‡∏•‡∏∞‡∏™‡∏°‡∏´‡∏ß‡∏±‡∏á‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏£" },
                { value: "2", text: "‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏õ‡∏µ‡∏ô‡∏µ‡πâ‡πÄ‡∏ï‡πá‡∏°‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏≠‡∏¢‡∏¢‡∏¥‡πâ‡∏°‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏ï‡∏•‡∏≠‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏õ‡∏µ" },
                { value: "3", text: "‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏û‡∏ö‡πÄ‡∏à‡∏≠‡πÅ‡∏ï‡πà‡∏™‡∏¥‡πà‡∏á‡∏î‡∏µ‡πÜ ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏ó‡∏≤‡∏á" },
                { value: "custom", text: "‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏≠‡∏á" }
            ],
            buddhist: [
                { value: "1", text: "‡∏ß‡∏±‡∏ô‡∏û‡∏£‡∏∞‡∏ô‡∏µ‡πâ ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏à‡∏¥‡∏ï‡πÉ‡∏à‡∏™‡∏á‡∏ö ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢‡∏™‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡∏õ‡∏±‡∏ç‡∏ç‡∏≤" },
                { value: "2", text: "‚Äò‡∏Ç‡∏¢‡∏≤‡∏ô‡∏∞‡∏ß‡∏≤ ‡∏≠‡∏õ‡∏∫‡∏õ‡∏°‡∏≤‡πÇ‡∏ó ‡∏≠‡∏°‡∏ï‡πç ‡∏õ‡∏ó‡πç‚Äô ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ó‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏ô‡∏ó‡∏≤‡∏á‡∏™‡∏π‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡∏ï‡∏≤‡∏¢ ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏™‡∏ï‡∏¥‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏¢‡πà‡∏≤‡∏á‡∏Å‡πâ‡∏≤‡∏ß" },
                { value: "3", text: "‚Äò‡∏™‡∏û‡∏∫‡∏û‡πç ‡∏ó‡∏≤‡∏ô‡πç ‡∏ò‡∏°‡∏∫‡∏°‡∏ó‡∏≤‡∏ô‡πç ‡∏ä‡∏¥‡∏ô‡∏≤‡∏ï‡∏¥‚Äô ‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ò‡∏£‡∏£‡∏°‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏≤‡∏ô‡∏¢‡∏¥‡πà‡∏á‡πÉ‡∏´‡∏ç‡πà ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡πÄ‡∏ï‡πá‡∏°‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏°‡∏ï‡∏ï‡∏≤" },
                { value: "4", text: "‡∏ß‡∏±‡∏ô‡∏û‡∏£‡∏∞‡∏ô‡∏µ‡πâ ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏®‡∏µ‡∏• ‡∏ù‡∏∂‡∏Å‡∏à‡∏¥‡∏ï‡πÉ‡∏´‡πâ‡∏ú‡πà‡∏≠‡∏á‡πÉ‡∏™ ‡πÅ‡∏•‡∏∞‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ó" },
                { value: "custom", text: "‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏≠‡∏á" }
            ]
        };

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏†‡∏≤‡∏û/‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏≤‡∏°‡πÄ‡∏ó‡∏®‡∏Å‡∏≤‡∏•
        function updateFestivalImage() {
            const now = new Date();
            const month = String(now.getMonth() + 1).padStart(2, '0'); // ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 01-12
            const day = String(now.getDate()).padStart(2, '0'); // ‡∏ß‡∏±‡∏ô 01-31
            const dateKey = `${month}-${day}`;
            const cardFront = document.getElementById('cardFront');
            const festivalMessage = document.getElementById('festivalMessage');

            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡∏û‡∏£‡∏∞ (‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏ß‡∏±‡∏ô‡∏û‡∏£‡∏∞‡∏ó‡∏∏‡∏Å 7 ‡∏ß‡∏±‡∏ô ‡πÄ‡∏ä‡πà‡∏ô ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 7, 14, 21, 28)
            const isBuddhistDay = [7, 14, 21, 28].includes(now.getDate());
            if (isBuddhistDay) {
                cardFront.style.background = `url('${festivalImages['buddhist'].url}') center/contain no-repeat`;
                festivalMessage.textContent = festivalImages['buddhist'].message;
                return;
            }

            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏ó‡∏®‡∏Å‡∏≤‡∏•‡∏≠‡∏∑‡πà‡∏ô‡πÜ
            if (festivalImages[dateKey]) {
                cardFront.style.background = `url('${festivalImages[dateKey].url}') center/contain no-repeat`;
                festivalMessage.textContent = festivalImages[dateKey].message;
            } else if (dateKey === '04-14') {
                // ‡∏Å‡∏£‡∏ì‡∏µ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 14 ‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå‡∏ó‡∏±‡∏ö)
                cardFront.style.background = `url('${festivalImages['04-14'].url}') center/contain no-repeat`;
                festivalMessage.textContent = festivalImages['04-14'].message;
            } else {
                // ‡πÉ‡∏ä‡πâ‡∏†‡∏≤‡∏û‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡∏ã‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ó‡∏®‡∏Å‡∏≤‡∏•‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏ß‡∏±‡∏ô‡πÄ‡∏ó‡∏®‡∏Å‡∏≤‡∏•
                cardFront.style.background = `url('${currentImageUrl}') center/contain no-repeat`;
                festivalMessage.textContent = '';
            }
        }

        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
        updateFestivalImage();

        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏≠‡∏ß‡∏¢‡∏û‡∏£
        function updateBlessingOptions() {
            const messageType = document.getElementById('messageType').value;
            const blessingSelect = document.getElementById('blessing');
            blessingSelect.innerHTML = '';
            const options = blessingOptions[messageType];
            options.forEach(option => {
                const opt = document.createElement('option');
                opt.value = option.value;
                opt.textContent = option.text;
                blessingSelect.appendChild(opt);
            });
            toggleCustomMessage();
        }

        function toggleCustomMessage() {
            const blessingSelect = document.getElementById('blessing');
            const customMessage = document.getElementById('customMessage');
            if (blessingSelect.value === 'custom') {
                customMessage.style.display = 'block';
            } else {
                customMessage.style.display = 'none';
                customMessage.value = '';
            }
        }

        function updateDateTime() {
            const now = new Date();
            const options = {
                day: '2-digit',
                month: 'short',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            };
            const dateTimeString = now.toLocaleString('th-TH', options)
                .replace(' ', ' ')
                .replace(',', '');
            document.getElementById('datetime').textContent = dateTimeString;
        }

        updateDateTime();
        setInterval(updateDateTime, 1000);

        function showProgress() {
            const overlay = document.getElementById('progressOverlay');
            const progressBar = document.getElementById('progressBar');
            overlay.style.display = 'flex';
            let progress = 0;
            progressBar.style.width = '0%';
            progressBar.textContent = '0%';
            const interval = setInterval(() => {
                progress += 10;
                progressBar.style.width = `${progress}%`;
                progressBar.textContent = `${progress}%`;
                if (progress >= 100) {
                    clearInterval(interval);
                }
            }, 100);
        }

        function hideProgress() {
            document.getElementById('progressOverlay').style.display = 'none';
        }

        function flipCard() {
            document.getElementById('card').classList.toggle('flipped');
        }

        function showPopup(message) {
            document.getElementById('popupMessage').textContent = message;
            document.getElementById('popup').style.display = 'block';
            document.getElementById('popupOverlay').style.display = 'block';
        }

        function hidePopup() {
            document.getElementById('popup').style.display = 'none';
            document.getElementById('popupOverlay').style.display = 'none';
        }

        function showImageChangePopup() {
            document.getElementById('imageChangePopup').style.display = 'block';
            document.getElementById('imageChangeOverlay').style.display = 'block';
            document.getElementById('imageFile').value = '';
        }

        function hideImageChangePopup() {
            document.getElementById('imageChangePopup').style.display = 'none';
            document.getElementById('imageChangeOverlay').style.display = 'none';
        }

        function changeImage() {
            const imageFile = document.getElementById('imageFile').files[0];
            if (imageFile) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const imageDataUrl = e.target.result;
                    showProgress();
                    setTimeout(() => {
                        localStorage.setItem('currentImage', imageDataUrl);
                        currentImageUrl = imageDataUrl;
                        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏†‡∏≤‡∏û‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏ß‡∏±‡∏ô‡πÄ‡∏ó‡∏®‡∏Å‡∏≤‡∏•
                        const now = new Date();
                        const month = String(now.getMonth() + 1).padStart(2, '0');
                        const day = String(now.getDate()).padStart(2, '0');
                        const dateKey = `${month}-${day}`;
                        const isBuddhistDay = [7, 14, 21, 28].includes(now.getDate());
                        if (!festivalImages[dateKey] && !isBuddhistDay) {
                            document.getElementById('cardFront').style.background = `url('${imageDataUrl}') center/contain no-repeat`;
                        }
                        hideProgress();
                        hideImageChangePopup();
                        showPopup('‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                    }, 1000);
                };
                reader.readAsDataURL(imageFile);
            } else {
                showPopup('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û');
            }
        }

        function dataURLtoBlob(dataURL) {
            const arr = dataURL.split(',');
            const mime = arr[0].match(/:(.*?);/)[1];
            const bstr = atob(arr[1]);
            let n = bstr.length;
            const u8arr = new Uint8Array(n);
            while (n--) {
                u8arr[n] = bstr.charCodeAt(n);
            }
            return new Blob([u8arr], { type: mime });
        }

        function submitBlessing() {
            const botToken = localStorage.getItem('botToken');
            const chatId = localStorage.getItem('chatId');

            if (!botToken || !chatId) {
                showPopup('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Bot Token ‡πÅ‡∏•‡∏∞ Chat ID ‡∏Å‡πà‡∏≠‡∏ô\n‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÇ‡∏î‡∏¢‡∏Ñ‡∏•‡∏¥‡∏Å‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏ü‡∏±‡∏ô‡πÄ‡∏ü‡∏∑‡∏≠‡∏á‡πÉ‡∏ô Navbar');
                return;
            }

            const messageTypeSelect = document.getElementById('messageType');
            const messageTypeText = messageTypeSelect.options[messageTypeSelect.selectedIndex].text;
            const blessingSelect = document.getElementById('blessing');
            let blessingText = blessingSelect.options[blessingSelect.selectedIndex].text;

            if (blessingSelect.value === 'custom') {
                blessingText = document.getElementById('customMessage').value.trim();
                if (!blessingText) {
                    showPopup('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏≠‡∏ß‡∏¢‡∏û‡∏£');
                    return;
                }
            }

            const firstName = document.getElementById('firstName').value;
            const lastName = document.getElementById('lastName').value;

            if (!firstName || !lastName) {
                showPopup('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡πÅ‡∏•‡∏∞‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô/‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î');
                return;
            }

            const message = `<b>üìú ${messageTypeText}</b>\n\n` +
                           `<b>‡∏Ñ‡∏≥‡∏≠‡∏ß‡∏¢‡∏û‡∏£:</b> ${blessingText}\n` +
                           `<b>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•:</b> ${firstName}\n` +
                           `<b>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° :</b> ${lastName}\n` +
                           `\n<i>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</i> ${new Date().toLocaleString('th-TH')}`;

            const popupMessage = `üìú ${messageTypeText}\n\n` +
                                 `‡∏Ñ‡∏≥‡∏≠‡∏ß‡∏¢‡∏û‡∏£: ${blessingText}\n` +
                                 `‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•: ${firstName}\n` +
                                 `‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° : ${lastName}\n` +
                                 `‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${new Date().toLocaleString('th-TH')}`;

            showProgress();
            setTimeout(() => {
                sendPhotoToTelegram()
                    .then(data => {
                        if (!data.ok) {
                            throw new Error(data.description);
                        }
                        return sendMessageToTelegram(message);
                    })
                    .then(data => {
                        hideProgress();
                        if (data.ok) {
                            showPopup(`${popupMessage}\n\n‡∏™‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!`);
                        } else {
                            showPopup(`${popupMessage}\n\n‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡πÑ‡∏õ Telegram: ${data.description}`);
                        }
                        flipCard();
                    })
                    .catch(error => {
                        hideProgress();
                        showPopup(`${popupMessage}\n\n‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡πÑ‡∏õ Telegram: ${error.message}`);
                        flipCard();
                    });
            }, 1000);
        }

        function sendPhotoToTelegram() {
            const botToken = localStorage.getItem('botToken');
            const chatId = localStorage.getItem('chatId');
            const url = `https://api.telegram.org/bot${botToken}/sendPhoto`;
            const blob = dataURLtoBlob(currentImageUrl);
            const formData = new FormData();
            formData.append('chat_id', chatId);
            formData.append('photo', blob, 'image.jpg');

            return fetch(url, {
                method: 'POST',
                body: formData
            })
                .then(response => response.json());
        }

        function sendMessageToTelegram(message) {
            const botToken = localStorage.getItem('botToken');
            const chatId = localStorage.getItem('chatId');
            const url = `https://api.telegram.org/bot${botToken}/sendMessage?chat_id=${chatId}&text=${encodeURIComponent(message)}&parse_mode=HTML`;
            return fetch(url)
                .then(response => response.json());
        }

        updateBlessingOptions();
    </script>
</body>
</html>
